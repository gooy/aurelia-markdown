{"version":3,"sources":["markdown.js"],"names":[],"mappings":";;;;;;;;;;;;;;gCAMO,mBAAmB;;wBACL,UAAU;;;;qBACb,OAAO;;;;IAMZ,QAAQ;;;;wBAAR,QAAQ;;;;aAED,IAAI;;;;;AAEX,WAJA,QAAQ,CAIP,OAAO,EAAC;;;;;AAClB,QAAI,CAAC,OAAO,GAAG,OAAO,CAAC;AACvB,QAAI,CAAC,SAAS,GAAG,IAAI,sBAAS,SAAS,EAAE,CAAC;GAC3C;;wBAPU,QAAQ;;WASX,oBAAE;AACR,UAAI,CAAC,IAAI,GAAG,IAAI,CAAC,OAAO,CAAC,UAAU,IAAI,IAAI,CAAC,OAAO,CAAC;AACpD,UAAG,CAAC,IAAI,CAAC,KAAK,EAAE;AACd,YAAI,CAAC,YAAY,CAAC,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC;OAC3C,MAAI;AACH,YAAI,CAAC,YAAY,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;OAC/B;KACF;;;WAEW,wBAAE;AACZ,UAAI,CAAC,YAAY,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;KAC/B;;;WAEW,sBAAC,QAAQ,EAAC;AACpB,UAAG,CAAC,IAAI,CAAC,IAAI,EAAE,OAAO;AACtB,UAAI,CAAC,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,CAAC;AAChE,UAAI,KAAK,GAAG,IAAI,CAAC,IAAI,CAAC,gBAAgB,CAAC,UAAU,CAAC,CAAC;;;;;;AACnD,6BAAgB,KAAK,8HAAE;cAAf,IAAI;;AACV,cAAI,CAAC,GAAG,IAAI,CAAC,SAAS,CAAC;;AAEvB,cAAI,CAAC,SAAS,GAAG,WAAW,GAAC,CAAC,CAAC;;AAE/B,cAAI,GAAG,GAAG,IAAI,CAAC,UAAU,CAAC;;AAE1B,aAAG,CAAC,SAAS,GAAG,WAAW,GAAC,CAAC,CAAC;;AAE9B,6BAAM,gBAAgB,CAAC,IAAI,CAAC,CAAC;SAC9B;;;;;;;;;;;;;;;KACF;;;kBArCU,QAAQ;AAAR,UAAQ,GADpB,8BAAO,OAAO,CAAC,CACH,QAAQ,KAAR,QAAQ;AAAR,UAAQ,GAFpB,+BAAQ,CAEI,QAAQ,KAAR,QAAQ;AAAR,UAAQ,GAHpB,qCAAc,UAAU,CAAC,CAGb,QAAQ,KAAR,QAAQ;AAAR,UAAQ,GAJpB,sCAAe,KAAK,CAAC,CAIT,QAAQ,KAAR,QAAQ;SAAR,QAAQ;;;;;AAwCrB,SAAS,MAAM,CAAC,GAAG,EAAC;AAClB,MAAI,KAAK,GAAG,GAAG,CAAC,KAAK,CAAC,iBAAiB,CAAC,CAAC;AACzC,MAAI,CAAC,KAAK,EAAE,OAAO,GAAG,CAAC;;AAEvB,MAAI,MAAM,GAAG,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,IAAI,EAAE,KAAK,CAAC,GAAG,CAAC,UAAU,EAAE,EAAE;AACxD,WAAO,EAAE,CAAC,MAAM,CAAC;GAClB,CAAC,CAAC,CAAC;;AAEJ,MAAI,EAAE,GAAG,IAAI,MAAM,CAAC,UAAU,GAAG,MAAM,GAAG,GAAG,EAAE,IAAI,CAAC,CAAC;AACrD,SAAO,MAAM,GAAG,CAAC,GAAG,GAAG,CAAC,OAAO,CAAC,EAAE,EAAE,EAAE,CAAC,GAAG,GAAG,CAAC;CAC/C","file":"markdown.js","sourceRoot":"/source/","sourcesContent":["import {\n  bindable,\n  noView,\n  customElement,\n  processContent,\n  inject\n} from 'aurelia-framework';\nimport showdown from 'showdown';\nimport prism from 'prism';\n\n@processContent(false)\n@customElement(\"markdown\")\n@noView()\n@inject(Element)\nexport class Markdown {\n\n  @bindable model = null;\n\n  constructor(element){\n    this.element = element;\n    this.converter = new showdown.Converter();\n  }\n\n  attached(){\n    this.root = this.element.shadowRoot || this.element;\n    if(!this.model) {\n      this.valueChanged(this.element.innerHTML);\n    }else{\n      this.valueChanged(this.model);\n    }\n  }\n\n  modelChanged(){\n    this.valueChanged(this.model);\n  }\n\n  valueChanged(newValue){\n    if(!this.root) return;\n    this.root.innerHTML = this.converter.makeHtml(dedent(newValue));\n    var codes = this.root.querySelectorAll('pre code');\n    for(var node of codes) {\n      var c = node.className;\n      //node.classList.remove(c);\n      node.className = \"language-\"+c;\n\n      var pre = node.parentNode;\n      //pre.classList.remove(c);\n      pre.className = \"language-\"+c;\n\n      prism.highlightElement(node);\n    }\n  }\n}\n\nfunction dedent(str){\n  var match = str.match(/^[ \\t]*(?=\\S)/gm);\n  if (!match) return str;\n\n  var indent = Math.min.apply(Math, match.map(function (el) {\n    return el.length;\n  }));\n\n  var re = new RegExp('^[ \\\\t]{' + indent + '}', 'gm');\n  return indent > 0 ? str.replace(re, '') : str;\n}\n"]}